<!DOCTYPE html><html data-debug-enabled="true" data-locale="es_ES" xmlns="http://www.w3.org/1999/xhtml"><head><meta content="Apache Tapestry Framework (version 5.4-beta-16)" name="generator"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta pagina="Post"/><title>#if DEBUG en Javascript (bueno, o algo así) | Variable not found</title><!-- Resources --><link type="text/css" rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:400,700"/><link type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"/><link title="Portada" type="application/atom+xml" rel="alternate" href="/feed.atom.xml"/><link type="image/png" rel="icon" href="/assets/images/favicon.png"/><meta content="Post" name="tapestry-page-name"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/bootstrap/css/bootstrap.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/tapestry.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/exception-frame.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/tapestry-console.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/tree.css"/><link type="text/css" rel="stylesheet" href="/assets/css/core.css"/></head><body data-page-initialized="false"><script type="text/javascript">document.write("<div class=\"pageloading-mask\"><div></div></div>");</script><header><div class="container-fluid"><div class="row"><div class="col-xs-12 col-sm-12 col-md-4"><h1><a class="blogstack" href="/"><span class="glyphicon glyphicon-th"></span> Blog <span class="stack">Stack</span></a></h1></div><div class="col-xs-12 col-sm-12 col-md-6"><nav role="navigation"><ul class="list-unstyled list-inline"><li><a class="header" href="/">Inicio</a></li><li><a class="header" href="/archive">Archivo</a></li><li><a class="header" href="/faq">Preguntas frecuentes</a></li><li><a class="header" href="/faq#aggregate">¿Quieres agregar tu bitácora?</a></li></ul></nav></div><div class="col-xs-6 col-sm-6 col-md-2"><a title="Fuente RSS, ¡suscríbete a BS!" alt="Fuente RSS" class="header" href="/feed.atom.xml"><span class="header icon entypo"></span></a><a title="Twitter, ¡sigue a BS!" alt="Twitter" class="header" href="http://twitter.com/blogstackinfo"><span class="header icon entypo-social"></span></a></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><h4>Un poco más que un agregador/planeta de bitácoras sobre programación, desarrollo, software libre, gnu/linux, tecnología, ...</h4></div></div></div><div class="container-fluid"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="imagen-cabecera"><div class="imagen"><div class="col-xs-12 col-sm-12 col-md-12" id="billboard"></div></div></div></div></div></div></header><div class="container-fluid content"><div class="row"><div class="col-xs-12 col-sm-12 col-md-8 content"><article itemtype="http://schema.org/BlogPosting" itemscope=""><a id="content"></a><header><h2><a href="/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi"><span itemprop="headline">#if DEBUG en Javascript (bueno, o algo así)</span></a></h2></header><div class="row labels"><div class="col-md-12"><a class="label" href="/label/javascript"><img title="javascript" alt="javascript" src="/assets/images/labels/javascript.png"/></a><a class="label" href="/label/asp-net"><img title="asp-net" alt="asp-net" src="/assets/images/labels/asp-net.png"/></a></div></div><section class="post-data"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div><span>Escrito por <span itemprop="author">José M. Aguilar</span> en la bitácora <a href="http://www.variablenotfound.com">Variable not found</a>, <a href="http://feedproxy.google.com/~r/vnf/~3/o-cpAy7BW6Y/if-debug-en-javascript-bueno-o-algo-asi.html"><span itemprop="sameAs">artículo original</span></a></span></div><div><span datetime="2014-07-22T11:55" itemprop="dateModified">Actualizado el martes, 22 de julio de 2014 a las 11:55 UTC</span></div><div><span>
Etiquetado como
<a href="/label/asp-net"><span itemprop="articleSection">asp-net</span></a>, depuracion, <a href="/label/javascript"><span itemprop="articleSection">javascript</span></a>, trucos</span></div></div></div></section><div class="text-justify post-content"><div class="share-this only-twitter"><span displayText="Tweet" class="st_twitter_vcount" st_url="http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi" st_title="#if DEBUG en Javascript (bueno, o algo así) | Variable not found"></span></div><script src="http://w.sharethis.com/button/buttons.js" type="text/javascript"></script><script type="text/javascript">stLight.options({publisher: "ur-3b2014fd-82e-9968-7e00-5ee51fb88bb2", doNotHash: true, doNotCopy: true, hashAddressBar: false});</script><span itemprop="name"><img align="right" alt="Debug" src="http://lh4.ggpht.com/-Ox2wyj3ZYSU/U8LGWzoGCtI/AAAAAAAADh0/ZB26rBsBkE0/image2.png?imgmax=800" height="128" style="background-image: none; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline; float: right; margin: 0px 0px 10px 10px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="Debug" width="128" />Hay veces que desde Javascript nos interesa ejecutar un c&oacute;digo u otro en funci&oacute;n de si la ejecuci&oacute;n se est&aacute; produciendo en un servidor de desarrollo o en uno de producci&oacute;n. Por ejemplo, en el primer caso suele ser interesante disponer de 
<em>logs</em> o herramientas de ayuda a la depuraci&oacute;n, mientras que en el segundo lo normal es que queramos introducir c&oacute;digo m&aacute;s eficiente y sin este tipo de condimentos.
<br />
<br />En este post vamos a ver algunas t&eacute;cnicas muy b&aacute;sicas que nos permitir&aacute;n ejecutar un c&oacute;digo u otro en el lado cliente de aplicaciones ASP.NET MVC (o ASP.NET en general) en funci&oacute;n del modo de compilaci&oacute;n.
<br />
<a></a>
<br />
<h3>1. El lado servidor</h3>En el lado servidor es bastante f&aacute;cil de conseguir porque disponemos de directivas de compilaci&oacute;n que nos permiten detectar si estamos generando los binarios en modo depuraci&oacute;n:
<br />
<pre>// HomeController.cs<br />public ActionResult Index()<br />{<br />    #if DEBUG<br />        ViewBag.CompilationInDebugMode = true;<br />    #else<br />        ViewBag.CompilationInDebugMode = false;<br />    #endif<br />    return View();<br />}<br /><br />@* Home/Index.cshtml *@<br />&lt;p&gt;Compilation in debug mode: @ViewBag.CompilationInDebugMode&lt;/p&gt;</pre>Tambi&eacute;n podemos conocer en tiempo de ejecuci&oacute;n si ASP.NET est&aacute; compilando en dicho modo (
<code>compilation debug=&quot;true&quot;</code> en el web.config):
<br />
<pre>@* In a Razor view: *@<br />&lt;p&gt;ASP.NET debugging: @Context.IsDebuggingEnabled&lt;/p&gt;</pre>Normalmente esta &uacute;ltima v&iacute;a ser&aacute; la que utilicemos, pues es la que suele indicar si estamos ejecutando sobre un servidor de desarrollo o no, b&aacute;sicamente porque el cambio en el web.config del valor del par&aacute;metro 
<code>debug</code> a 
<code>false</code> es uno de esos pasos que 
<a href="http://weblogs.asp.net/scottgu/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled">nos han recomendado desde el principio de los tiempos</a> al pasar una aplicaci&oacute;n a producci&oacute;n. Y seguro que todos lo hacemos, &iquest;verdad? ;-)
<br />
<h3>2. &iquest;Y el lado cliente?</h3>En el lado cliente, debido a la propia naturaleza din&aacute;mica del lenguaje Javascript, no existe una compilaci&oacute;n en modo depuraci&oacute;n; bueno, de hecho no existe ni siquiera compilaci&oacute;n como tal ;-), por lo que tenemos que recurrir a algunos truquillos para conseguir emular este comportamiento.
<br />
<h4>2.1. Cargar scripts diferentes en funci&oacute;n del modo de depuraci&oacute;n de ASP.NET</h4>Una posibilidad muy sencilla, y v&aacute;lida en algunos escenarios, es tener un archivo de script diferente para cada modo de compilaci&oacute;n. De hecho, es empleada por muchas bibliotecas Javascript, que se distribuyen en forma de archivo .js para la versi&oacute;n de producci&oacute;n, normalmente ya compactada y minimizada, y .debug.js para la versi&oacute;n a utilizar durante el desarrollo.
<br />
<br />Por ejemplo, supongamos que tenemos los dos siguientes archivos:
<br />
<pre>// File: Myscript.debug.js (development script)<br />function log(msg) {<br />    console.log(msg);<br />}<br /><br />// =====================================<br /><br />// File: Myscript.js (production script)<br />function log(msg) {<br />    // Nothing to do<br />}</pre>Para cargar manualmente un archivo u otro en funci&oacute;n del modo de compilaci&oacute;n bastar&iacute;a con hacer lo siguiente a la hora de referenciarlo:
<br />
<pre>&lt;script src=&quot;~/scripts/myscript@(Context.IsDebuggingEnabled? &quot;.debug&quot;: &quot;&quot;).js&quot;&gt;<br />&lt;/script&gt;</pre>Sin embargo, 
<strong>si utilizamos bundles es a&uacute;n m&aacute;s sencillo</strong>: de serie, el sistema de 
<i>bundling</i> ya distinguir&aacute; entre las distintas versiones de forma autom&aacute;tica bas&aacute;ndose en la extensi&oacute;n de los archivos. Por ejemplo, continuando con el caso anterior, al a&ntilde;adir un 
<em>bundle</em> como el siguiente el mismo componente de optimizaci&oacute;n seleccionar&aacute; el archivo myscript.debug.js cuando la depuraci&oacute;n de ASP.NET est&eacute; activada, y myscript.js en caso contrario:
<br />
<pre>bundles.Add(new ScriptBundle(&quot;~/bundles/myscript&quot;).Include(<br />                &quot;~/Scripts/myscript.*&quot;<br />            ));</pre>La referencia desde la vista en este caso ser&iacute;a as&iacute; de simple:
<br />
<pre>@Scripts.Render(&quot;~/bundles/myscript&quot;)</pre>
<h4>2.2. Detecci&oacute;n inline del modo de depuraci&oacute;n</h4>Pero no siempre el grano es tan grueso como en el apartado anterior. Muy frecuentemente no nos interesar&aacute; sustituir completamente un script por otro en funci&oacute;n del modo de compilaci&oacute;n, sino conocer simplemente el modo en el que estamos para tomar una decisi&oacute;n a nivel de c&oacute;digo. Esto nos permitir&iacute;a escribir c&oacute;digo como el siguiente:
<br />
<pre>function doSomething() {<br />    if (DEBUG_MODE) {<br />        log(&quot;Entering doSomething()&quot;);<br />    }<br />    // ... Code<br />    if (DEBUG_MODE) {<br />        log(&quot;Exiting doSomething()&quot;);<br />    }<br />}</pre>Por tanto, nuestro problema se reduce a establecer esa constante 
<code>DEBUG_MODE</code> a un valor que eval&uacute;e a cierto cuando estemos ejecutando sobre una aplicaci&oacute;n compilada en modo depuraci&oacute;n y a falso en caso contrario. Y aplicando lo visto anteriormente, podr&iacute;amos conseguirlo de varias formas.
<br />
<br />Una, realmente sencilla de implementar, consistir&iacute;a en introducir un conciso bloque de scripts antes de cargar las bibliotecas o scripts que usen este valor, por ejemplo en el encabezado del 
<em>layout</em> o p&aacute;gina maestra del sitio web, m&aacute;s o menos con lo siguiente:
<br />
<br />
<pre>@* Razor Layout *@<br />...<br />&lt;head&gt;<br />    &lt;meta charset=&quot;utf-8&quot; /&gt;<br />    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;<br />    &lt;title&gt;My ASP.NET Application&lt;/title&gt;<br />    @Styles.Render(&quot;~/Content/css&quot;)<br />    @Scripts.Render(&quot;~/bundles/modernizr&quot;)<br />    &lt;script&gt;<br />        window.DEBUG_MODE = @(Context.IsDebuggingEnabled? &quot;true&quot;: &quot;false&quot;);<br />    &lt;/script&gt;<br />&lt;/head&gt;<br />...</pre>Otra posibilidad ser&iacute;a establecer el valor de 
<code>DEBUG_MODE</code> en un script independiente del que tendr&iacute;amos dos versiones, con extensiones .debug.js y .js, que respectivamente lo inicializar&iacute;an a 
<code>true</code> y 
<code>false</code>, y usar cualquiera de las dos t&eacute;cnicas descritas anteriormente para cargar uno u otro en funci&oacute;n del modo de compilaci&oacute;n.
<br />
<br />Publicado en 
<a href="http://www.variablenotfound.com/">Variable not found</a>.
<div> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:ecdYMiMMAMM"><img src="http://feeds.feedburner.com/~ff/vnf?d=ecdYMiMMAMM" /></a> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/vnf?d=yIl2AUoC8zA" /></a> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/vnf?d=qj6IDK7rITs" /></a> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:4cEx4HpKnUU"><img src="http://feeds.feedburner.com/~ff/vnf?i=o-cpAy7BW6Y:sfbXulwSC60:4cEx4HpKnUU" /></a> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/vnf?i=o-cpAy7BW6Y:sfbXulwSC60:F7zBnMyn0Lo" /></a> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/vnf?i=o-cpAy7BW6Y:sfbXulwSC60:gIN9vFwOqvQ" /></a> 
 <a href="http://feeds.feedburner.com/~ff/vnf?a=o-cpAy7BW6Y:sfbXulwSC60:I9og5sOYxJI"><img src="http://feeds.feedburner.com/~ff/vnf?d=I9og5sOYxJI" /></a> 
</div>
<img src="http://feeds.feedburner.com/~r/vnf/~4/o-cpAy7BW6Y" height="1" width="1" /></span></div><section><a id="share"></a><h1>Compartir</h1><div class="share-this"><span displayText="Tweet" class="st_twitter_vcount" st_url="http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi" st_title="#if DEBUG en Javascript (bueno, o algo así) | Variable not found"></span><span displayText="Facebook" class="st_facebook_vcount" st_url="http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi" st_title="#if DEBUG en Javascript (bueno, o algo así) | Variable not found"></span><span displayText="Google +" class="st_googleplus_vcount" st_url="http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi" st_title="#if DEBUG en Javascript (bueno, o algo así) | Variable not found"></span><span displayText="LinkedIn" class="st_linkedin_vcount" st_url="http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi" st_title="#if DEBUG en Javascript (bueno, o algo así) | Variable not found"></span><span displayText="Meneame" class="st_meneame_vcount" st_url="http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi" st_title="#if DEBUG en Javascript (bueno, o algo así) | Variable not found"></span></div><script src="http://w.sharethis.com/button/buttons.js" type="text/javascript"></script><script type="text/javascript">stLight.options({publisher: "ur-3b2014fd-82e-9968-7e00-5ee51fb88bb2", doNotHash: true, doNotCopy: true, hashAddressBar: false});</script><div id="widget"></div></section><hr/></article></div><div class="col-xs-12 col-sm-12 col-md-4"><aside><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section><h3>¡Suscríbete!</h3><ul class="list-unstyled"><li><a href="/label/asp-net/feed.atom.xml"><span class="fa fa-rss"></span> Fuente de la etiqueta asp-net</a></li><li><a href="/label/javascript/feed.atom.xml"><span class="fa fa-rss"></span> Fuente de la etiqueta javascript</a></li></ul></section></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div id="bigRectangle"></div></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section><h3>Redes sociales</h3><p>¿Te gusta Blog Stack? ¡Compártelo!</p><div class="social-networks"><!-- Facebook --><div class="social-network"><div data-share="true" data-show-faces="false" data-action="like" data-width="310" data-layout="box_count" data-href="http://www.blogstack.info/" class="fb-like"></div></div><!-- Google+ --><div class="social-network"><div class="g-plusone" data-href="http://www.blogstack.info/" data-size="tall"></div></div></div></section></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section id="lastPosts"></section></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div id="bigSkycraper"></div></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section id="lastPosts_0"></section></div></div></aside></div></div></div><footer><div class="container-fluid"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="footer"><a href="/">Blog Stack</a> por <a href="https://twitter.com/picodotdev/">pico.dev</a> está publicado bajo la licencia de software libre <a href="http://www.gnu.org/licenses/agpl-3.0.html">GNU Affero General Public</a> en <a href="https://github.com/picodotdev/blog-stack">GitHub <span class="entypo-social"></span></a>.<br/>
El contenido agregado conserva la licencia de su bitácora.<br/>
«Powered by» <a href="https://github.com/picodotdev/blogstack">Blog Stack</a>, <a href="http://tapestry.apache.org/">Apache Tapestry</a>, <a href="https://www.openshift.com/">OpenShift</a>, <a href="https://pages.github.com/">GitHub Pages</a>, <a href="http://www.oracle.com/es/technologies/java/overview/index.html">Java</a> y más software libre o de código abierto, inspirado en <a href="http://octopress.org/">Octopress</a>.<br/><span class="copyleft">©</span> pico.dev 2015
</div></div></div></div></footer><div id="fb-root"></div><script type="text/javascript">var require = {
  "waitSeconds" : 300,
  "shim" : {
    "t5/core/typeahead" : [
      "jquery"
    ],
    "bootstrap/affix" : [
      "bootstrap/transition"
    ],
    "bootstrap/alert" : [
      "bootstrap/transition"
    ],
    "bootstrap/modal" : [
      "bootstrap/transition"
    ],
    "bootstrap/tab" : [
      "bootstrap/transition"
    ],
    "bootstrap/transition" : [
      "jquery"
    ],
    "bootstrap/button" : [
      "bootstrap/transition"
    ],
    "bootstrap/scrollspy" : [
      "bootstrap/transition"
    ],
    "bootstrap/collapse" : [
      "bootstrap/transition"
    ],
    "bootstrap/dropdown" : [
      "bootstrap/transition"
    ],
    "bootstrap/tooltip" : [
      "bootstrap/transition"
    ],
    "bootstrap/carousel" : [
      "bootstrap/transition"
    ],
    "bootstrap/popover" : [
      "bootstrap/tooltip"
    ]
  },
  "baseUrl" : "/modules"
};
</script><script src="/assets/tapestry5/require.js" type="text/javascript"></script><script src="/assets/tapestry5/underscore-1.5.2.js" type="text/javascript"></script><script src="/assets/tapestry5/scriptaculous_1_9_0/prototype.js" type="text/javascript"></script><script src="/assets/tapestry5/scriptaculous_1_9_0/scriptaculous.js" type="text/javascript"></script><script src="/assets/tapestry5/scriptaculous_1_9_0/effects.js" type="text/javascript"></script><script src="/assets/tapestry5/t53-compatibility.js" type="text/javascript"></script><script src="/assets/tapestry5/jquery.js" type="text/javascript"></script><script src="/assets/tapestry5/jquery-noconflict.js" type="text/javascript"></script><script type="text/javascript">require(["t5/core/pageinit"], function(pi) { pi([], [
  "app/analytics",
  [
    "app/karmacracy:init",
    {
      "selector" : "#widget",
      "id" : 791,
      "url" : "http://www.blogstack.info/post/variablenotfound/2014/07/if-debug-en-javascript-bueno-o-algo-asi"
    }
  ],
  "app/facebook",
  "app/googleplus",
  [
    "app/lastPosts:init",
    {
      "id" : "lastPosts",
      "source" : "variablenotfound",
      "name" : "Variable not found"
    }
  ],
  [
    "app/lastPosts:init",
    {
      "id" : "lastPosts_0",
      "source" : "blogstack",
      "name" : "Blog Stack"
    }
  ],
  [
    "app/adsensem:init",
    {
      "blogstack" : {
        "adClient" : "ca-pub-3533636310991304",
        "adSlot" : "1397019380"
      }
    }
  ]
]); });</script></body></html>