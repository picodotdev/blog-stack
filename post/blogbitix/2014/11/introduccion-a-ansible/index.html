<!DOCTYPE html><html data-debug-enabled="true" data-locale="es_ES" xmlns="http://www.w3.org/1999/xhtml"><head><meta content="Apache Tapestry Framework (version 5.4-beta-16)" name="generator"/><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta pagina="Post"/><title>Introducción a Ansible | Blog Bitix</title><!-- Resources --><link type="text/css" rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:400,700"/><link type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"/><link title="Portada" type="application/atom+xml" rel="alternate" href="/feed.atom.xml"/><link type="image/png" rel="icon" href="/assets/images/favicon.png"/><meta content="Post" name="tapestry-page-name"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/bootstrap/css/bootstrap.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/tapestry.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/exception-frame.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/tapestry-console.css"/><link type="text/css" rel="stylesheet" href="/assets/tapestry5/tree.css"/><link type="text/css" rel="stylesheet" href="/assets/css/core.css"/></head><body data-page-initialized="false"><script type="text/javascript">document.write("<div class=\"pageloading-mask\"><div></div></div>");</script><header><div class="container-fluid"><div class="row"><div class="col-xs-12 col-sm-12 col-md-4"><h1><a class="blogstack" href="/"><span class="glyphicon glyphicon-th"></span> Blog <span class="stack">Stack</span></a></h1></div><div class="col-xs-12 col-sm-12 col-md-6"><nav role="navigation"><ul class="list-unstyled list-inline"><li><a class="header" href="/">Inicio</a></li><li><a class="header" href="/archive">Archivo</a></li><li><a class="header" href="/faq">Preguntas frecuentes</a></li><li><a class="header" href="/faq#aggregate">¿Quieres agregar tu bitácora?</a></li></ul></nav></div><div class="col-xs-6 col-sm-6 col-md-2"><a title="Fuente RSS, ¡suscríbete a BS!" alt="Fuente RSS" class="header" href="/feed.atom.xml"><span class="header icon entypo"></span></a><a title="Twitter, ¡sigue a BS!" alt="Twitter" class="header" href="http://twitter.com/blogstackinfo"><span class="header icon entypo-social"></span></a></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><h4>Un poco más que un agregador/planeta de bitácoras sobre programación, desarrollo, software libre, gnu/linux, tecnología, ...</h4></div></div></div><div class="container-fluid"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="imagen-cabecera"><div class="imagen"><div class="col-xs-12 col-sm-12 col-md-12" id="billboard"></div></div></div></div></div></div></header><div class="container-fluid content"><div class="row"><div class="col-xs-12 col-sm-12 col-md-8 content"><article itemtype="http://schema.org/BlogPosting" itemscope=""><a id="content"></a><header><h2><a href="/post/blogbitix/2014/11/introduccion-a-ansible"><span itemprop="headline">Introducción a Ansible</span></a></h2></header><div class="row labels"><div class="col-md-12"><a class="label" href="/label/linux"><img title="linux" alt="linux" src="/assets/images/labels/linux.png"/></a></div></div><section class="post-data"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div><span>Escrito por <span itemprop="author">pico.dev</span> en la bitácora <a href="http://picodotdev.github.io/blog-bitix/">Blog Bitix</a>, <a href="http://picodotdev.github.io/blog-bitix/2014/11/introduccion-a-ansible/"><span itemprop="sameAs">artículo original</span></a></span></div><div><span datetime="2014-11-15T13:00" itemprop="dateModified">Actualizado el sábado, 15 de noviembre de 2014 a las 13:00 UTC</span></div><div><span>
Etiquetado como
blog-stack, planeta-linux, planeta-codigo, planeta-arch-linux, <a href="/label/linux"><span itemprop="articleSection">linux</span></a></span></div></div></div></section><div class="text-justify post-content"><div class="share-this only-twitter"><span displayText="Tweet" class="st_twitter_vcount" st_url="http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible" st_title="Introducción a Ansible | Blog Bitix"></span></div><script src="http://w.sharethis.com/button/buttons.js" type="text/javascript"></script><script type="text/javascript">stLight.options({publisher: "ur-3b2014fd-82e-9968-7e00-5ee51fb88bb2", doNotHash: true, doNotCopy: true, hashAddressBar: false});</script><span itemprop="name"><div style="float: right; text-align: right;"> 
 <img src="http://picodotdev.github.io/blog-bitix/images/custom/logotipos/ansible.png" alt="Ansible" title="Ansible" />
 <br /> 
</div> 
<p>Siempre que nos sea posible deber&iacute;amos automatizar las tareas que realizamos. Automatizar tareas har&aacute; sencillo realizarlas permiti&eacute;ndonos hacer todos los despliegues de una aplicaci&oacute;n que queramos con menos posibilidades de cometer errores manuales o nos permitir&aacute; disponer de una nueva m&aacute;quina aprovisionada exactamente como pueda estar la m&aacute;quina de producci&oacute;n en mucho menos tiempo. En el &aacute;mbito del aprovisionamiento de m&aacute;quinas y administraci&oacute;n de la infraestructura IT hay varias opciones, entre ellas est&aacute;n <a href="https://www.getchef.com/">Chef</a>, <a href="http://puppetlabs.com/">Puppet</a> y <a href="http://www.ansible.com">Ansible</a>.</p> 
<p>En este art&iacute;culo har&eacute; una breve introducci&oacute;n de Ansible que principalmente se emplea en servidores pero tambi&eacute;n podr&iacute;amos emplearlo para nuestra propia m&aacute;quina. Con Ansible podremos:</p> 
<ul> 
 <li>Automatizar el aprovisionamiento de m&aacute;quinas.</li> 
 <li>Gestionar la configuraci&oacute;n de los servicios de esas m&aacute;quinas.</li> 
 <li>Realizar despliegues y orquestar los servicios.</li> 
</ul> 
<p>Hay que destacar que Ansible no necesita instalar un agente (al contrario de Chef o Puppet) en cada una de las m&aacute;quinas del inventario que queramos administrar lo que lo hace f&aacute;cil de emplear, usa un modelo &laquo;push&raquo; en el que la m&aacute;quina donde se ejecuta Ansible env&iacute;a por ssh los comandos necesarios a aplicar en vez de ser cada una de las m&aacute;quinas las que obtienen de un repositorio las recetas a usar. En los art&iacute;culos <a href="http://www.ansible.com/application-deployment">Application Deployment</a>, <a href="http://www.ansible.com/configuration-management">Configuration Management</a> y <a href="http://www.ansible.com/continuous-delivery">Continous Delivery</a> nos describen algunos casos de uso y sus ventajas empleando Ansible.</p> 
<p>Para trabajar con Ansible necesitaremos inventariar las m&aacute;quinas y probablemente definir algunas variables. Podr&iacute;a ser de la siguiente forma en el caso de una m&aacute;quina para desarrollar.</p> 
<p></p>
<div>
 <script src="https://gist.github.com/picodotdev/b2f77fc1b2f1987c8aef.js?file=hosts"></script> 
 <noscript>
  <pre><code>devbox ansible_connection=local ansible_python_interpreter=python2

[devbox]
devbox

[devbox:vars]
path = &quot;projects&quot;
subversion_user = &quot;picodotdev&quot;
subversion_password = &quot;***&quot;</code></pre>
 </noscript>
</div> 
<p></p> 
<p>En el inventario descrito como un archivo en formato INI se asignan los nombres del host o sus direcciones IP, tambi&eacute;n se pueden hacer agrupaciones de m&aacute;quinas por ejemplo en base al rol (base de datos, servidor web, …). Una vez que disponemos del inventario podemos empezar a usar Ansible, por ejemplo haciendo un ping a todas las m&aacute;quinas o instalando un determinado paquete:</p> 
<p></p>
<div>
 <script src="https://gist.github.com/picodotdev/b2f77fc1b2f1987c8aef.js?file=ansible.sh"></script> 
 <noscript>
  <pre><code>$ ansible devbox -i hosts -m ping
$ ansible devbox -i hosts -m pacman -a &quot;name=docker state=installed&quot;</code></pre>
 </noscript>
</div> 
<p></p> 
<div style="text-align: center;"> 
 <a href="http://picodotdev.github.io/blog-bitix/images/custom/posts/52/ansible.png" title="Ansible"><img src="http://picodotdev.github.io/blog-bitix/images/custom/posts/52/ansible-thumb.png" /></a> 
</div> 
<p>El par&aacute;metro -m indica el m&oacute;dulo de Ansible que usamos y a continuaci&oacute;n indicamos los par&aacute;metros. Ansible dispone de una amplia <a href="http://docs.ansible.com/list_of_all_modules.html">colecci&oacute;n de m&oacute;dulos</a> que nos permiten hacer cantidad de tareas.</p> 
<p>Pero en vez de usar Ansible mediante comandos podemos emplear recetas contenidas en <a href="http://docs.ansible.com/playbooks.html">playbooks</a> descritos en formato YAML en las que definimos varias tareas y podemos usar las variables del inventario. Con el siguiente playbook instalamos varios paquetes en una m&aacute;quina Arch Linux y hacemos un checkout de dos proyectos de subversion, para ello usamos en la primera tarea el m&oacute;dulo para gestionar paquetes con pacman, hay m&oacute;dulos para los gestores de paquetes de otras distribuciones (apt, yum, …) y en la segunda tarea hacemos un checkout de dos proyectos usando el m&oacute;dulo del sistema de control de versiones subversion. Los m&oacute;dulos son idempotentes de forma que una vez que el sistema est&aacute; en el estado deseado no se realiza la operaci&oacute;n, esto hace que el mismo playbook pueda ser ejecutado tantas veces como se desee evitando efectos colaterales por reejecuciones, lo importante es el estado que se quiere conseguir, Ansible se encarga de realizar las acciones necesarias para llegar a &eacute;l desde el estado actual del sistema.</p> 
<p></p>
<div>
 <script src="https://gist.github.com/picodotdev/b2f77fc1b2f1987c8aef.js?file=install.yml"></script> 
 <noscript>
  <pre><code>- hosts: devbox
  tasks:
    - name: install packages (Arch Linux)
      pacman: name={{ item }} state=present
      sudo: true
      when: ansible_distribution == &quot;Archlinux&quot;
      with_items:
      - vim
      - subversion
      - mariadb
      - redis
      - docker
      - ansible
      - python2-pip
      - python2-virtualenv

    - name: checkout projects
      environment:
          LANG: es_ES.UTF-8
          LC_CTYPE: es_ES.UTF-8
      subversion: repo={{ item.url }} dest={{ projects }}/{{ item.path }} username={{ subversion_user }} password={{ subversion_password }}
      with_items:
      - { url: &quot;http://server.com/svn/repos/project1/trunk&quot;, path: &quot;project1&quot; }
      - { url: &quot;http://server.com/svn/repos/project2/trunk&quot;, path: &quot;project2&quot; }</code></pre>
 </noscript>
</div> 
<p></p> 
<p>Para ejecutar un playbook usamos el comando ansible-playbook en vez de simplemente el comando ansible.</p> 
<p></p>
<div>
 <script src="https://gist.github.com/picodotdev/b2f77fc1b2f1987c8aef.js?file=ansible-playbook-install.sh"></script> 
 <noscript>
  <pre><code>$ ansible-playbook ansible/install.yml -i hosts</code></pre>
 </noscript>
</div> 
<p></p> 
<p>En los playbooks podemos usar tareas, grupos de m&aacute;quinas, variables, variables de grupos, asignar valores a variables, usar condicionales, bucles, hechos (facts, informaci&oacute;n obtenida por ansible), notificaciones y realizar acciones en base a ellas, aplicar etiquetas a tareas, hacer includes, plantillas (para los archivos de configuraci&oacute;n de los servicios, por ejemplo de apache o mysql), esperar a condiciones, cifrar archivos que contengan informaci&oacute;n sensible y que podamos incluir en una herramienta de control de versiones sin riesgo a comprometer la informaci&oacute;n, usar roles que aplican todas estas cosas seg&uacute;n la funci&oacute;n que queramos que tenga una m&aacute;quina.</p> 
<p>El libro <a href="http://www.ansible.com/ansible-book">Ansible Up &amp; Running</a> es un buen punto de partida que explica los aspectos b&aacute;sicos ya en su versi&oacute;n de vista previa, por supuesto la propia <a href="http://docs.ansible.com/index.html">documentaci&oacute;n del proyecto</a> y los <a href="http://www.ansible.com/resources">recursos de evangelizaci&oacute;n</a> est&aacute;n bastante bien. En la siguiente buena y completa presentaci&oacute;n se explican con un poco m&aacute;s detalle m&aacute;s cosas:</p> 
<script async="async" class="speakerdeck-embed" data-id="e02a4f70ee4d01312be742839f79c6f5" data-ratio="1.33333333333333" src="https://speakerdeck.com/assets/embed.js"></script> 
<p>Tambi&eacute;n, en el siguiente <a href="https://github.com/ansible/ansible-examples">repositorio de GitHub hay varios ejemplos</a> que podemos revisar para ver como se organizan los archivos y carpetas y las convenciones en su estructura que se usan impl&iacute;citamente.</p> 
<p>Habiendo hecho una <a href="http://picodotdev.github.io/blog-bitix/2014/10/introduccion-y-caracteristicas-de-docker/">introducci&oacute;n a Docker</a> y esta a Ansible en el siguiente art&iacute;culo comentar&eacute; como usar Docker con Ansible.</p> 
<p>Referencia:<br /> <a href="http://en.wikipedia.org/wiki/Ansible_%28software%29">Art&iacute;culo en la wikipedia</a><br /> <a href="https://speakerdeck.com/slok/ansible-all-the-things">Presentaci&oacute;n sobre Ansible</a><br /> <a href="https://github.com/ansible/ansible-examples">Ansible examples</a><br /> <a href="http://picodotdev.github.io/blog-bitix/2014/10/introduccion-y-caracteristicas-de-docker/">Introducci&oacute;n a Docker</a><br /> <a href="http://picodotdev.github.io/blog-bitix/2014/11/inicio-basico-de-docker/">Gu&iacute;a de inicio b&aacute;sico de Docker</a><br /> <a href="http://picodotdev.github.io/blog-bitix/2014/11/como-crear-una-imagen-para-docker-usando-un-dockerfile/">C&oacute;mo crear una imagen para Docker usando un Dockerfile</a><br /></p></span></div><section><a id="share"></a><h1>Compartir</h1><div class="share-this"><span displayText="Tweet" class="st_twitter_vcount" st_url="http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible" st_title="Introducción a Ansible | Blog Bitix"></span><span displayText="Facebook" class="st_facebook_vcount" st_url="http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible" st_title="Introducción a Ansible | Blog Bitix"></span><span displayText="Google +" class="st_googleplus_vcount" st_url="http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible" st_title="Introducción a Ansible | Blog Bitix"></span><span displayText="LinkedIn" class="st_linkedin_vcount" st_url="http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible" st_title="Introducción a Ansible | Blog Bitix"></span><span displayText="Meneame" class="st_meneame_vcount" st_url="http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible" st_title="Introducción a Ansible | Blog Bitix"></span></div><script src="http://w.sharethis.com/button/buttons.js" type="text/javascript"></script><script type="text/javascript">stLight.options({publisher: "ur-3b2014fd-82e-9968-7e00-5ee51fb88bb2", doNotHash: true, doNotCopy: true, hashAddressBar: false});</script><div id="widget"></div></section><section><a id="comments"></a><h1>Comentar</h1><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = "blog-bitix";
var disqus_title = "Introducción a Ansible";
var disqus_url = "http://picodotdev.github.io/blog-bitix/2014/11/introduccion-a-ansible/";
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a class="dsq-brlink" href="http://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a></section><hr/></article></div><div class="col-xs-12 col-sm-12 col-md-4"><aside><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section><h3>¡Suscríbete!</h3><ul class="list-unstyled"><li><a href="/label/linux/feed.atom.xml"><span class="fa fa-rss"></span> Fuente de la etiqueta linux</a></li></ul></section></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div id="bigRectangle"></div></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section><h3>Redes sociales</h3><p>¿Te gusta Blog Stack? ¡Compártelo!</p><div class="social-networks"><!-- Facebook --><div class="social-network"><div data-share="true" data-show-faces="false" data-action="like" data-width="310" data-layout="box_count" data-href="http://www.blogstack.info/" class="fb-like"></div></div><!-- Google+ --><div class="social-network"><div class="g-plusone" data-href="http://www.blogstack.info/" data-size="tall"></div></div></div></section></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section id="lastPosts"></section></div></div><div class="row"><div class="col-xs-3 col-md-2"><div id="wideSkycraper"></div></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><section id="lastPosts_0"></section></div></div></aside></div></div></div><footer><div class="container-fluid"><div class="row"><div class="col-xs-12 col-sm-12 col-md-12"><div class="footer"><a href="/">Blog Stack</a> por <a href="https://twitter.com/picodotdev/">pico.dev</a> está publicado bajo la licencia de software libre <a href="http://www.gnu.org/licenses/agpl-3.0.html">GNU Affero General Public</a> en <a href="https://github.com/picodotdev/blog-stack">GitHub <span class="entypo-social"></span></a>.<br/>
El contenido agregado conserva la licencia de su bitácora.<br/>
«Powered by» <a href="https://github.com/picodotdev/blogstack">Blog Stack</a>, <a href="http://tapestry.apache.org/">Apache Tapestry</a>, <a href="https://www.openshift.com/">OpenShift</a>, <a href="https://pages.github.com/">GitHub Pages</a>, <a href="http://www.oracle.com/es/technologies/java/overview/index.html">Java</a> y más software libre o de código abierto, inspirado en <a href="http://octopress.org/">Octopress</a>.<br/><span class="copyleft">©</span> pico.dev 2014
</div></div></div></div></footer><div id="fb-root"></div><script type="text/javascript">var require = {
  "waitSeconds" : 300,
  "shim" : {
    "t5/core/typeahead" : [
      "jquery"
    ],
    "bootstrap/affix" : [
      "bootstrap/transition"
    ],
    "bootstrap/alert" : [
      "bootstrap/transition"
    ],
    "bootstrap/modal" : [
      "bootstrap/transition"
    ],
    "bootstrap/tab" : [
      "bootstrap/transition"
    ],
    "bootstrap/transition" : [
      "jquery"
    ],
    "bootstrap/button" : [
      "bootstrap/transition"
    ],
    "bootstrap/scrollspy" : [
      "bootstrap/transition"
    ],
    "bootstrap/collapse" : [
      "bootstrap/transition"
    ],
    "bootstrap/dropdown" : [
      "bootstrap/transition"
    ],
    "bootstrap/tooltip" : [
      "bootstrap/transition"
    ],
    "bootstrap/carousel" : [
      "bootstrap/transition"
    ],
    "bootstrap/popover" : [
      "bootstrap/tooltip"
    ]
  },
  "baseUrl" : "/modules"
};
</script><script src="/assets/tapestry5/require.js" type="text/javascript"></script><script src="/assets/tapestry5/underscore-1.5.2.js" type="text/javascript"></script><script src="/assets/tapestry5/scriptaculous_1_9_0/prototype.js" type="text/javascript"></script><script src="/assets/tapestry5/scriptaculous_1_9_0/scriptaculous.js" type="text/javascript"></script><script src="/assets/tapestry5/scriptaculous_1_9_0/effects.js" type="text/javascript"></script><script src="/assets/tapestry5/t53-compatibility.js" type="text/javascript"></script><script src="/assets/tapestry5/jquery.js" type="text/javascript"></script><script src="/assets/tapestry5/jquery-noconflict.js" type="text/javascript"></script><script type="text/javascript">require(["t5/core/pageinit"], function(pi) { pi([], [
  "app/analytics",
  [
    "app/karmacracy:init",
    {
      "selector" : "#widget",
      "id" : 1120,
      "url" : "http://www.blogstack.info/post/blogbitix/2014/11/introduccion-a-ansible"
    }
  ],
  "app/disqus",
  "app/facebook",
  "app/googleplus",
  [
    "app/lastPosts:init",
    {
      "id" : "lastPosts",
      "source" : "blogbitix",
      "name" : "Blog Bitix"
    }
  ],
  [
    "app/lastPosts:init",
    {
      "id" : "lastPosts_0",
      "source" : "blogstack",
      "name" : "Blog Stack"
    }
  ],
  [
    "app/adsensem:init",
    {
      "blogstack" : {
        "adClient" : "ca-pub-3533636310991304",
        "adSlotBillboard" : "1397019380",
        "adSlotHorizontalSkycraper" : "1397019380",
        "adSlotBigRectangle" : "2873752587",
        "adSlotWideSkycraper" : "1896546988"
      },
      "ad" : {
        "adClient" : "ca-pub-3533636310991304",
        "adSlotBillboard" : "1397019380",
        "adSlotHorizontalSkycraper" : "1397019380",
        "adSlotBigRectangle" : "2873752587",
        "adSlotWideSkycraper" : "1896546988"
      }
    }
  ]
]); });</script></body></html>